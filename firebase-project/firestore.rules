rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // Existing scenes collection for real-time collaboration
    match /scenes/{roomId} {
      allow get, write: if true;
      allow list: if false;
    }
    
    // TEMPORARY: Workspaces collection - allow all operations for development
    // TODO: Integrate Clerk with Firebase Auth for proper security
    // See FIRESTORE_AUTH_INTEGRATION.md for details
    match /workspaces/{workspaceId} {
      // Allow all operations (temporary for development)
      allow read, write: if true;

      // Boards within a workspace
      match /boards/{boardId} {
        allow read, write: if true;

        // Board content
        match /content/{contentId} {
          allow read, write: if true;
        }
      }
    }

    // PRODUCTION RULES (commented out - requires Clerk + Firebase integration):
    // match /workspaces/{workspaceId} {
    //   allow create: if request.auth != null
    //     && request.resource.data.ownerUserId == request.auth.uid;
    //   allow read, update, delete: if request.auth != null
    //     && resource.data.ownerUserId == request.auth.uid;
    //   match /boards/{boardId} {
    //     allow read, write: if request.auth != null
    //       && get(/databases/$(database)/documents/workspaces/$(workspaceId)).data.ownerUserId == request.auth.uid;
    //     match /content/{contentId} {
    //       allow read, write: if request.auth != null
    //         && get(/databases/$(database)/documents/workspaces/$(workspaceId)).data.ownerUserId == request.auth.uid;
    //     }
    //   }
    // }
  }
}
